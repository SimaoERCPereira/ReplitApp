{% extends "base.html" %}

{% block content %}
<h1 class="text-2xl font-bold mb-6">Premier League</h1>
<div class="bg-white rounded-lg shadow mb-8">
    <div class="flex flex-col md:flex-row md:items-center justify-between px-6 py-4 border-b">
        <h3 class="text-lg font-semibold flex items-center gap-2 mb-2 md:mb-0"><i class="fas fa-futbol"></i> Matches</h3>
        {% if all_gameweeks %}
        <form method="GET" action="{{ url_for('home') }}" class="flex items-center gap-2">
            <select name="gameweek" id="gameweek-select" class="border rounded px-3 py-2 focus:outline-none focus:ring focus:border-blue-400" onchange="this.form.submit()" aria-label="Select Gameweek">
                {% for gw in all_gameweeks %}
                    <option value="{{ gw }}" {% if gw == selected_gameweek %}selected{% endif %}>Gameweek {{ gw }}</option>
                {% endfor %}
            </select>
            <noscript><button type="submit" class="ml-2 px-3 py-1 rounded bg-blue-600 text-white">View</button></noscript>
        </form>
        {% endif %}
    </div>
    <ul>
        {% for match in matches %}
        <li class="flex flex-col md:flex-row md:items-center justify-between px-6 py-4 border-b last:border-b-0 hover:bg-gray-50 transition">
            <a href="{{ url_for('match_discussion', match_id=match.id) }}" class="flex-1 flex items-center gap-4">
                <div class="flex items-center gap-2">
                    {% if match.home_team and match.home_team.logo_url %}
                        <img src="{{ match.home_team.logo_url }}" alt="{{ match.home_team.name }}" class="w-8 h-8 object-contain rounded-full">
                    {% endif %}
                    <span class="font-semibold">{{ match.home_team.name if match.home_team else 'N/A' }}</span>
                </div>
                <span class="mx-2 text-gray-400 font-mono">vs</span>
                <div class="flex items-center gap-2">
                    {% if match.away_team and match.away_team.logo_url %}
                        <img src="{{ match.away_team.logo_url }}" alt="{{ match.away_team.name }}" class="w-8 h-8 object-contain rounded-full">
                    {% endif %}
                    <span class="font-semibold">{{ match.away_team.name if match.away_team else 'N/A' }}</span>
                </div>
            </a>
            <div class="flex flex-col items-end mt-2 md:mt-0 min-w-[120px]">
                <span class="font-mono text-xs text-gray-500">{{ match.match_date.strftime('%b %d, %H:%M') if match.match_date else 'No date' }}</span>
                {% if match.status == 'Finished' %}
                    <span class="inline-block mt-1 px-2 py-1 rounded bg-gray-700 text-white font-mono text-xs">FT {{ match.score_team1 if match.score_team1 is not none else '-' }} : {{ match.score_team2 if match.score_team2 is not none else '-' }}</span>
                {% elif match.status == 'Live' %}
                    <span class="inline-block mt-1 px-2 py-1 rounded bg-red-500 text-white font-mono text-xs animate-pulse">{{ match.score_team1 if match.score_team1 is not none else '0' }} : {{ match.score_team2 if match.score_team2 is not none else '0' }}</span>
                {% elif match.status == 'Upcoming' %}
                    <span class="inline-block mt-1 px-2 py-1 rounded bg-green-500 text-white font-mono text-xs">Upcoming</span>
                {% else %}
                    <span class="inline-block mt-1 px-2 py-1 rounded bg-gray-300 text-gray-700 font-mono text-xs">{{ match.status }}</span>
                {% endif %}
            </div>
        </li>
        {% else %}
        <li class="text-center text-gray-400 py-8">
            {% if selected_gameweek %}
                No matches found for Gameweek {{ selected_gameweek }}.
            {% else %}
                No matches or gameweeks available at this time.
            {% endif %}
        </li>
        {% endfor %}
    </ul>
</div>
{% endblock %}
