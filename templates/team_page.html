{% extends "base.html" %}

{% block content %}
<div class="relative mb-8 bg-white rounded-lg shadow overflow-hidden">
    <div class="h-32 bg-gradient-to-r from-blue-600 to-blue-400 relative">
        {% if team.logo_url %}
        <div class="absolute top-1/2 left-8 transform -translate-y-1/2 bg-white rounded-full w-24 h-24 flex items-center justify-center shadow-lg">
            <img src="{{ team.logo_url }}" alt="{{ team.name }}" class="max-w-[80px] max-h-[80px]">
        </div>
        {% endif %}
    </div>
    <div class="p-6">
        <div class="flex flex-col md:flex-row md:items-start justify-between gap-4">
            <div>
                <h1 class="text-2xl font-bold mb-1">{{ team.name }}</h1>
                <div class="flex items-center gap-4 text-gray-400 text-sm">
                    <span><i class="fas fa-map-marker-alt"></i> {{ team.stadium }}</span>
                    <span><i class="fas fa-users"></i> {{ team.fans_count }} fans</span>
                </div>
            </div>
            <div>
                {% if current_user.is_authenticated %}
                <button class="px-4 py-2 rounded border border-blue-600 text-blue-600 font-semibold hover:bg-blue-50 transition"><i class="fas fa-star"></i> Follow Team</button>
                {% endif %}
            </div>
        </div>
    </div>
</div>
<div class="flex flex-col md:flex-row gap-8">
    <div class="flex-1">
        <div class="bg-white rounded-lg shadow mb-8">
            <div class="px-6 py-4 border-b">
                <h3 class="text-lg font-semibold mb-0 flex items-center gap-2"><i class="fas fa-newspaper"></i> Team News & Updates</h3>
            </div>
            <div class="px-6 py-6">
                {% if current_user.is_authenticated %}
                <form class="mb-6">
                    <textarea class="w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:border-blue-400 mb-2" placeholder="Share news or thoughts about {{ team.name }}..." rows="3"></textarea>
                    <div class="flex justify-between items-center">
                        <div class="flex gap-2">
                            <button type="button" class="px-3 py-1 rounded border border-gray-300 text-gray-600 font-semibold hover:bg-gray-100 transition text-xs"><i class="fas fa-image"></i> Photo</button>
                            <button type="button" class="px-3 py-1 rounded border border-gray-300 text-gray-600 font-semibold hover:bg-gray-100 transition text-xs"><i class="fas fa-poll"></i> Poll</button>
                        </div>
                        <button type="submit" class="px-4 py-2 rounded bg-blue-600 text-white font-semibold hover:bg-blue-700 transition text-xs"><i class="fas fa-paper-plane"></i> Post</button>
                    </div>
                </form>
                {% endif %}
                <div>
                    {% for item in team.news %}
                    <div class="border-b last:border-b-0 pb-6 mb-6">
                        <h4 class="text-base font-semibold mb-1">{{ item.title }}</h4>
                        <p>{{ item.summary }}</p>
                        <div class="flex justify-between items-center mt-3">
                            <span class="text-xs text-gray-400"><i class="fas fa-calendar-alt"></i> {{ item.date }}</span>
                            <div class="flex gap-2">
                                <button class="px-3 py-1 rounded border border-gray-300 text-gray-600 font-semibold hover:bg-gray-100 transition text-xs"><i class="fas fa-thumbs-up"></i> Like</button>
                                <button class="px-3 py-1 rounded border border-gray-300 text-gray-600 font-semibold hover:bg-gray-100 transition text-xs"><i class="fas fa-comment"></i> Comment</button>
                            </div>
                        </div>
                    </div>
                    {% else %}
                    <div class="text-center py-8 text-gray-400">
                        <i class="fas fa-newspaper text-2xl mb-2"></i>
                        <p>No team news available at the moment.</p>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        <div class="bg-white rounded-lg shadow mb-8">
            <div class="px-6 py-4 border-b">
                <h3 class="text-lg font-semibold mb-0 flex items-center gap-2"><i class="fas fa-poll"></i> Fan Polls</h3>
            </div>
            <div class="px-6 py-6">
                <h4 class="font-semibold mb-2">Player of the Month</h4>
                <form>
                    <div class="mb-3">
                        <label class="flex items-center gap-2"><input type="radio" name="player_poll" class="mr-2"> Player A (37%)</label>
                        <div class="h-1.5 bg-gray-200 rounded mt-1"><div class="h-1.5 bg-blue-600 rounded" style="width: 37%"></div></div>
                    </div>
                    <div class="mb-3">
                        <label class="flex items-center gap-2"><input type="radio" name="player_poll" class="mr-2"> Player B (48%)</label>
                        <div class="h-1.5 bg-gray-200 rounded mt-1"><div class="h-1.5 bg-blue-600 rounded" style="width: 48%"></div></div>
                    </div>
                    <div class="mb-3">
                        <label class="flex items-center gap-2"><input type="radio" name="player_poll" class="mr-2"> Player C (15%)</label>
                        <div class="h-1.5 bg-gray-200 rounded mt-1"><div class="h-1.5 bg-blue-600 rounded" style="width: 15%"></div></div>
                    </div>
                    <div class="text-right mt-4">
                        <button type="submit" class="px-4 py-2 rounded bg-blue-600 text-white font-semibold hover:bg-blue-700 transition text-xs">Vote</button>
                    </div>
                </form>
                <div class="border-t mt-6 pt-6">
                    <h4 class="font-semibold mb-2">Will we finish in the top 4?</h4>
                    <div class="flex mt-4 mb-2">
                        <div class="flex-6 h-8 bg-green-500 rounded-l flex items-center justify-center text-white font-semibold">Yes (60%)</div>
                        <div class="flex-4 h-8 bg-red-500 rounded-r flex items-center justify-center text-white font-semibold">No (40%)</div>
                    </div>
                    <div class="text-center text-gray-400 text-xs">Based on 235 votes</div>
                </div>
            </div>
        </div>
    </div>
    <div class="w-full md:w-1/3 flex flex-col gap-8">
        <div class="bg-white rounded-lg shadow">
            <div class="px-6 py-4 border-b">
                <h3 class="text-lg font-semibold mb-0 flex items-center gap-2"><i class="fas fa-chart-line"></i> Team Stats</h3>
            </div>
            <div class="px-6 py-6">
                <div class="flex justify-around text-center border-b pb-4 mb-4">
                    <div>
                        <div class="text-2xl font-bold text-green-600">{{ team.win }}</div>
                        <div class="text-gray-400 text-xs">Wins</div>
                    </div>
                    <div>
                        <div class="text-2xl font-bold text-yellow-500">{{ team.draw }}</div>
                        <div class="text-gray-400 text-xs">Draws</div>
                    </div>
                    <div>
                        <div class="text-2xl font-bold text-red-500">{{ team.loss }}</div>
                        <div class="text-gray-400 text-xs">Losses</div>
                    </div>
                </div>
                <div class="flex justify-between items-center border-b pb-4 mb-4">
                    <div>
                        <div class="font-semibold">Current Position</div>
                        <div class="text-gray-400 text-xs">Premier League</div>
                    </div>
                    <div class="text-xl font-bold text-blue-600">{{ team.position }}{% if team.position == 1 %}st{% elif team.position == 2 %}nd{% elif team.position == 3 %}rd{% else %}th{% endif %}</div>
                </div>
                <div>
                    <div class="font-semibold mb-2">Recent Form</div>
                    <div class="flex gap-2 mt-2">
                        {% if team.form %}
                            {% for result_raw in team.form.split(',')[:5] %}
                                {% set res_upper = result_raw|trim|upper if result_raw else '' %}
                                {% set display_char = res_upper if res_upper in ['W', 'D', 'L'] else (result_raw|trim if result_raw and result_raw|trim else '-') %}
                                {% set class_suffix = res_upper if res_upper in ['W', 'D', 'L'] else 'N' %}
                                <span class="inline-block px-2 py-1 rounded font-mono text-xs mx-0.5 {{
                                    'bg-green-500 text-white' if class_suffix == 'W' else
                                    'bg-yellow-400 text-slate-900' if class_suffix == 'D' else
                                    'bg-red-500 text-white' if class_suffix == 'L' else
                                    'bg-gray-300 text-gray-700'
                                }}" title="{{ 'Win' if class_suffix == 'W' else ('Loss' if class_suffix == 'L' else ('Draw' if class_suffix == 'D' else 'N/A')) }}">
                                    {{ display_char }}
                                </span>
                            {% endfor %}
                        {% else %}
                            <span class="text-gray-400">No recent form data available</span>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        <div class="bg-white rounded-lg shadow">
            <div class="px-6 py-4 border-b">
                <h3 class="text-lg font-semibold mb-0 flex items-center gap-2"><i class="fas fa-calendar-alt"></i> Upcoming Fixtures</h3>
            </div>
            <ul>
                <li class="flex justify-between items-center px-6 py-3 border-b last:border-b-0">
                    <span>vs Arsenal (H)</span>
                    <span class="text-xs font-mono text-gray-400">May 16, 2025</span>
                </li>
                <li class="flex justify-between items-center px-6 py-3 border-b last:border-b-0">
                    <span>vs Chelsea (A)</span>
                    <span class="text-xs font-mono text-gray-400">May 23, 2025</span>
                </li>
                <li class="flex justify-between items-center px-6 py-3 border-b last:border-b-0">
                    <span>vs Man City (H)</span>
                    <span class="text-xs font-mono text-gray-400">May 30, 2025</span>
                </li>
                <li class="text-center px-6 py-3">
                    <a href="#" class="inline-block px-4 py-2 rounded border border-gray-300 text-gray-600 font-semibold hover:bg-gray-100 transition text-xs"><i class="fas fa-calendar-alt"></i> View Full Fixture List</a>
                </li>
            </ul>
        </div>
    </div>
</div>
{% endblock %}
