{% extends "base.html" %}

{% block content %}    <div class="match-header-info" style="margin-bottom: 2rem; padding: 1.5rem; background-color: var(--surface-color); border-radius: var(--border-radius-lg); box-shadow: var(--box-shadow); position: relative; overflow: hidden;">
        <!-- Background pattern for visual appeal -->
        <div style="position: absolute; top: 0; left: 0; right: 0; height: 8px; background: linear-gradient(to right, var(--primary-color), var(--accent-color));"></div>
        
        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
            <div style="display: flex; align-items: center; flex: 1; justify-content: flex-end; padding-right: 20px;">
                {% if match.home_team and match.home_team.logo_url %}
                    <img src="{{ match.home_team.logo_url }}" alt="{{ match.home_team.name }}" style="height: 48px; width: auto; margin-right: 12px;">
                {% endif %}
                <span class="team-name" style="font-size: 1.5rem; font-weight: 700;">{{ match.home_team.name if match.home_team else 'N/A' }}</span>
            </div>
            
            <div style="text-align: center; padding: 0 15px; display: flex; flex-direction: column; align-items: center;">
                {% if match.status == 'Finished' %}
                    <div class="match-score" style="font-size: 1.8rem; font-weight: 700; min-width: 100px; background-color: var(--secondary-color); color: var(--surface-color); padding: 6px 15px; border-radius: var(--border-radius); margin-bottom: 8px;">
                        {{ match.score_team1 if match.score_team1 is not none else '0' }} : {{ match.score_team2 if match.score_team2 is not none else '0' }}
                    </div>
                    <span class="badge" style="background-color: var(--secondary-color); margin-bottom: 8px;">Full Time</span>
                {% elif match.status == 'Live' %}
                    <div class="match-score badge-live" style="font-size: 1.8rem; font-weight: 700; min-width: 100px; background-color: var(--danger-color); color: var(--surface-color); padding: 6px 15px; border-radius: var(--border-radius); margin-bottom: 8px;">
                        {{ match.score_team1 if match.score_team1 is not none else '0' }} : {{ match.score_team2 if match.score_team2 is not none else '0' }}
                    </div>
                    <span class="badge badge-live" style="margin-bottom: 8px;">LIVE</span>
                {% elif match.status == 'Upcoming' %}
                    <div class="match-time" style="font-size: 1.3rem; font-weight: 600; margin-bottom: 8px;">
                        <i class="far fa-clock" style="margin-right: 5px;"></i> {{ match.match_date.strftime('%H:%M') if match.match_date else 'TBD' }}
                    </div>
                    <span class="badge" style="background-color: var(--accent-color); margin-bottom: 8px;">Upcoming</span>                {% else %}
                    <div class="match-time vs-divider" style="font-size: 1.3rem; font-weight: 600; margin-bottom: 8px; text-align: center; width: 100%; font-family: var(--font-family-monospace);">vs</div>
                    <span class="badge" style="background-color: var(--text-color-muted); margin-bottom: 8px;">{{ match.status }}</span>
                {% endif %}
                
                <div class="match-date text-monospace text-small" style="color: var(--text-color-muted);">
                    {{ match.match_date.strftime('%A, %b %d, %Y') if match.match_date else 'Date TBD' }}
                </div>
                
                {% if match.gameweek %}
                <div class="gameweek text-small" style="margin-top: 5px;">
                    <span class="badge badge-info">Gameweek {{ match.gameweek }}</span>
                </div>
                {% endif %}
            </div>
            
            <div style="display: flex; align-items: center; flex: 1; justify-content: flex-start; padding-left: 20px;">
                <span class="team-name" style="font-size: 1.5rem; font-weight: 700;">{{ match.away_team.name if match.away_team else 'N/A' }}</span>
                {% if match.away_team and match.away_team.logo_url %}
                    <img src="{{ match.away_team.logo_url }}" alt="{{ match.away_team.name }}" style="height: 48px; width: auto; margin-left: 12px;">
                {% endif %}
            </div>
        </div>
    </div>    <div class="card">
        <div class="card-header">
            <h3 style="font-size: 1.25rem; margin-bottom:0;"><i class="fas fa-comments"></i> Match Discussion</h3>
        </div>
        <div class="card-body">
            {% if current_user.is_authenticated %}
            <form method="POST" action="{{ url_for('match_discussion', match_id=match.id) }}" style="margin-bottom: 2rem;">
                <div class="form-group">
                    <textarea id="commentText" name="comment" class="form-control" placeholder="What are your thoughts on this match? (Max 280 characters)" maxlength="280" required rows="3"></textarea>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span class="text-small text-color-muted">
                        <i class="fas fa-info-circle"></i> Maximum 280 characters
                    </span>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-paper-plane"></i> Post Comment
                    </button>
                </div>
            </form>
            {% else %}
            <div style="background-color: rgba(59, 130, 246, 0.1); border-radius: var(--border-radius); padding: 1rem; margin-bottom: 1.5rem; text-align: center;">
                <p style="margin-bottom: 0.5rem;">
                    <i class="fas fa-lock" style="color: var(--primary-color); margin-right: 0.5rem;"></i>
                    Please <a href="{{ url_for('login', next=request.url) }}">login</a> to join the conversation
                </p>
            </div>
            {% endif %}

            <h4 style="font-size: 1.1rem; border-bottom: 1px solid var(--border-color); padding-bottom: 0.5rem; margin-top: 1rem;">
                <i class="fas fa-comment-dots"></i> 
                {% if comments|length > 0 %}
                    {{ comments|length }} {{ 'Comments' if comments|length > 1 else 'Comment' }}
                {% else %}
                    No Comments Yet
                {% endif %}
            </h4>

            <div class="comments-container" style="margin-top: 1rem;">
                {% for comment in comments %}
                    <div class="comment" style="padding: 1rem; border-bottom: 1px solid var(--border-color); display: flex; gap: 1rem;">
                        <div class="comment-avatar" style="flex-shrink: 0; width: 40px; height: 40px; background-color: var(--primary-color); border-radius: 50%; display: flex; justify-content: center; align-items: center; color: var(--surface-color); font-weight: bold;">
                            {{ comment.author.username[:1].upper() }}
                        </div>
                        <div class="comment-content" style="flex-grow: 1;">
                            <div class="comment-header" style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;">
                                <span class="comment-author" style="font-weight: 600; color: var(--text-color);">{{ comment.author.username }}</span>
                                <span class="comment-time text-monospace text-small" style="color: var(--text-color-muted);">{{ comment.timestamp.strftime('%b %d, %Y %H:%M') }}</span>
                            </div>
                            <p class="comment-text" style="margin-bottom: 0; font-size: 0.95rem;">{{ comment.text }}</p>
                        </div>
                    </div>
                {% else %}
                    <div class="no-comments text-center" style="padding: 2rem 0;">
                        <div style="color: var(--text-color-lighter); margin-bottom: 0.5rem;">
                            <i class="fas fa-comments" style="font-size: 2rem;"></i>
                        </div>
                        <p style="color: var(--text-color-muted);">Be the first to share your thoughts about this match!</p>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <div style="text-align: center; margin-top: 2rem;">
        <a href="{{ url_for('home') }}" class="btn btn-secondary">Back to Feed</a>
    </div>
{% endblock %}
